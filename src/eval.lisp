(load "./src/movegen.lisp")

;;Dumb eval function that simple check for mobility and piece values to determine the value of a position.
(defun simple-eval (b)
  (let* ((color (color b))
	 (copy b)
	 (boards (boards b))
	 (wki (bitLength (aref boards white king)))
	 (bki (bitLength (aref boards black king)))
	 (wq (bitLength (aref boards white queen)))
	 (bq (bitLength (aref boards black queen)))
	 (wr (bitLength (aref boards white rook)))
	 (br (bitLength (aref boards black rook)))
	 (wb (bitLength (aref boards white bishop)))
	 (bb (bitLength (aref boards black bishop)))
	 (wk (bitLength (aref boards white knight)))
	 (bk (bitLength (aref boards black knight)))
	 (wp (bitLength (aref boards white pawn)))
	 (bp (bitLength (aref boards black pawn)))
         (wm (progn  
	       (setColor copy white) 
	       (length (generate-all-moves copy))))
	 (bm (progn  
	       (setColor copy black) 
	       (length (generate-all-moves copy))))
	 (val (+ (* 200 (- wki bki))
		 (* 9 (- wq bq))
		 (* 5 (- wr br))
		 (* 3 (+ (- wb bb) (- wk bk)))
		 (* 1 (- wp bp))
		 (* 0.1 (- wm bm)))))
    (setColor copy color)
    val))

